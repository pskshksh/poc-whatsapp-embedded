{"ast":null,"code":"var _jsxFileName = \"/Users/ayoubidel/Desktop/embeddedsignup/front/src/App.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useCallback } from \"react\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst CONFIG = {\n  APP_ID: \"1187395139713463\",\n  API_VERSION: \"v23.0\",\n  CONFIG_ID: \"2282335175549472\",\n  BACKEND_URL: \"http://localhost:8081\",\n  REDIRECT_URI: \"https://c6c766eee161.ngrok-free.app\"\n};\nexport default function App() {\n  _s();\n  var _businessInfo$phone_n;\n  const [isSDKLoaded, setIsSDKLoaded] = useState(false);\n  const [sdkError, setSdkError] = useState(null);\n  const [status, setStatus] = useState(\"idle\");\n  const [message, setMessage] = useState(\"\");\n  const [businessInfo, setBusinessInfo] = useState(null);\n  const [nextSteps, setNextSteps] = useState([]);\n  const [appValidation, setAppValidation] = useState(null);\n\n  // Validate Facebook App ID\n  const validateAppId = useCallback(async () => {\n    try {\n      console.log(\"Validating Facebook App ID...\");\n      const response = await fetch(`https://graph.facebook.com/v23.0/${CONFIG.APP_ID}?fields=id,name,link`);\n      const data = await response.json();\n      if (response.ok && data.id) {\n        console.log(\"✅ App ID is valid:\", data);\n        setAppValidation({\n          valid: true,\n          data\n        });\n      } else {\n        var _data$error, _data$error2;\n        console.error(\"❌ App ID validation failed:\", data);\n        setAppValidation({\n          valid: false,\n          error: ((_data$error = data.error) === null || _data$error === void 0 ? void 0 : _data$error.message) || \"App ID not found\"\n        });\n        setSdkError(`Invalid App ID: ${((_data$error2 = data.error) === null || _data$error2 === void 0 ? void 0 : _data$error2.message) || \"App not found\"}`);\n      }\n    } catch (error) {\n      console.error(\"❌ App validation network error:\", error);\n      setAppValidation({\n        valid: false,\n        error: \"Network error during validation\"\n      });\n      setSdkError(\"Network error validating App ID\");\n    }\n  }, []);\n\n  // Enhanced Facebook SDK loading\n  const loadFacebookSDK = useCallback(() => {\n    console.log(\"Starting Facebook SDK load process...\");\n    setSdkError(null);\n\n    // Validate App ID first\n    validateAppId();\n\n    // Set up fbAsyncInit BEFORE loading script\n    window.fbAsyncInit = function () {\n      console.log(\"fbAsyncInit called, initializing FB SDK...\");\n      try {\n        window.FB.init({\n          appId: CONFIG.APP_ID,\n          cookie: true,\n          xfbml: false,\n          version: CONFIG.API_VERSION\n        });\n        console.log(\"FB.init completed, checking status...\");\n\n        // Test the SDK immediately\n        window.FB.getLoginStatus(function (response) {\n          console.log(\"Initial FB login status:\", response);\n          setIsSDKLoaded(true);\n          setSdkError(null);\n          console.log(\"✅ Facebook SDK fully initialized and tested\");\n        });\n      } catch (error) {\n        console.error(\"❌ FB.init failed:\", error);\n        setSdkError(`SDK initialization failed: ${error.message}`);\n      }\n    };\n\n    // Check if FB SDK already exists\n    if (window.FB && window.FB.init) {\n      console.log(\"Facebook SDK already loaded, testing...\");\n      try {\n        window.FB.getLoginStatus(function (response) {\n          console.log(\"Existing FB SDK status:\", response);\n          setIsSDKLoaded(true);\n          setSdkError(null);\n        });\n        return;\n      } catch (error) {\n        console.log(\"Existing FB SDK has issues, reloading...\");\n        window.FB = undefined;\n      }\n    }\n\n    // Remove any existing script\n    const existingScript = document.getElementById(\"facebook-jssdk\");\n    if (existingScript) {\n      console.log(\"Removing existing FB SDK script...\");\n      existingScript.remove();\n    }\n\n    // Create and load new script\n    console.log(\"Loading Facebook SDK script...\");\n    const script = document.createElement(\"script\");\n    script.id = \"facebook-jssdk\";\n    script.async = true;\n    script.defer = true;\n    script.crossOrigin = \"anonymous\";\n    script.src = \"https://connect.facebook.net/en_US/sdk.js\";\n    script.onload = () => {\n      console.log(\"✅ Facebook SDK script loaded successfully\");\n    };\n    script.onerror = error => {\n      console.error(\"❌ Failed to load Facebook SDK script:\", error);\n      setSdkError(\"Failed to load Facebook SDK script. Check your internet connection or if Facebook is blocked.\");\n    };\n    document.head.appendChild(script);\n\n    // Timeout fallback\n    setTimeout(() => {\n      if (!isSDKLoaded) {\n        console.warn(\"⚠️ Facebook SDK initialization timeout\");\n        setSdkError(\"Facebook SDK took too long to initialize. This might indicate:\");\n        setMessage(\"• Your app is in Development mode\\n• Invalid App ID\\n• Network/firewall issues\\n• Facebook domains blocked\");\n      }\n    }, 15000);\n  }, [validateAppId, isSDKLoaded]);\n  useEffect(() => {\n    loadFacebookSDK();\n  }, [loadFacebookSDK]);\n\n  // Enhanced message listener\n  useEffect(() => {\n    const messageListener = event => {\n      console.log(\"Received message event:\", event);\n      const validOrigins = [\"https://www.facebook.com\", \"https://business.facebook.com\"];\n      const isValidOrigin = validOrigins.some(origin => event.origin === origin || event.origin.endsWith(\".facebook.com\"));\n      if (!isValidOrigin) {\n        console.log(\"Ignoring message from invalid origin:\", event.origin);\n        return;\n      }\n      try {\n        const data = typeof event.data === \"string\" ? JSON.parse(event.data) : event.data;\n        console.log(\"Parsed message data:\", data);\n        if ((data === null || data === void 0 ? void 0 : data.type) === \"WA_EMBEDDED_SIGNUP\") {\n          console.log(\"🟢 WA Embedded Signup event:\", data);\n          if (data.event === \"FINISH\") {\n            console.log(\"✅ Signup completed successfully:\", data.data);\n          } else if (data.event === \"CANCEL\") {\n            var _data$data;\n            console.log(\"❌ Signup cancelled:\", data.data);\n            setStatus(\"error\");\n            setMessage(`Signup cancelled at: ${((_data$data = data.data) === null || _data$data === void 0 ? void 0 : _data$data.current_step) || \"unknown step\"}`);\n          } else {\n            console.log(\"ℹ️ Other signup event:\", data.event);\n          }\n        }\n      } catch (parseError) {\n        console.log(\"Non-JSON message received:\", event.data);\n      }\n    };\n    window.addEventListener(\"message\", messageListener);\n    return () => window.removeEventListener(\"message\", messageListener);\n  }, []);\n  const testFBConnection = () => {\n    if (!window.FB) {\n      alert(\"Facebook SDK not loaded\");\n      return;\n    }\n    console.log(\"Testing Facebook connection...\");\n    window.FB.getLoginStatus(function (response) {\n      console.log(\"FB Connection Test Result:\", response);\n      alert(`FB Status: ${response.status}`);\n    });\n  };\n  const startSignup = () => {\n    if (!isSDKLoaded || !window.FB) {\n      setMessage(\"Facebook SDK not ready. Please wait or refresh the page.\");\n      return;\n    }\n    console.log(\"🚀 Starting WhatsApp Business signup...\");\n    setStatus(\"loading\");\n    setMessage(\"Opening WhatsApp Business signup...\");\n    const loginConfig = {\n      config_id: CONFIG.CONFIG_ID,\n      response_type: \"code\",\n      override_default_response_type: true,\n      extras: {\n        setup: {},\n        featureType: \"\",\n        sessionInfoVersion: \"3\"\n      }\n    };\n    console.log(\"FB.login config:\", loginConfig);\n    window.FB.login(response => {\n      var _response$authRespons;\n      console.log(\"📥 FB.login response received:\", response);\n      if (response.error) {\n        console.error(\"❌ FB.login error:\", response.error);\n        setStatus(\"error\");\n        setMessage(`Facebook login error: ${response.error.message || JSON.stringify(response.error)}`);\n        return;\n      }\n      if (response.status === \"connected\" && (_response$authRespons = response.authResponse) !== null && _response$authRespons !== void 0 && _response$authRespons.code) {\n        const code = response.authResponse.code;\n        console.log(\"✅ Authorization code received, length:\", code.length);\n        setupBusinessAccount(code);\n      } else {\n        console.log(\"❌ No authorization code received. Full response:\", response);\n        setStatus(\"error\");\n        setMessage(`No authorization code received. Status: ${response.status}. This may indicate the signup was cancelled or the app configuration is incorrect.`);\n      }\n    }, loginConfig);\n  };\n  const setupBusinessAccount = async authCode => {\n    try {\n      setMessage(\"Server is processing your WhatsApp Business setup...\");\n      console.log(\"📤 Sending to backend with code length:\", authCode.length);\n      const requestPayload = {\n        authorization_code: authCode,\n        redirect_uri: CONFIG.REDIRECT_URI,\n        client_info: {\n          user_agent: navigator.userAgent,\n          timestamp: new Date().toISOString(),\n          app_validation: appValidation\n        }\n      };\n      const res = await fetch(`${CONFIG.BACKEND_URL}/api/whatsapp/setup`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(requestPayload)\n      });\n      const result = await res.json();\n      console.log(\"📥 Backend response:\", result);\n      if (result.success) {\n        setStatus(\"success\");\n        setMessage(result.message || \"WhatsApp Business setup completed.\");\n        setBusinessInfo(result.business_info || null);\n        setNextSteps(result.next_steps || []);\n      } else {\n        throw new Error(result.error || `Server error: ${res.status}`);\n      }\n    } catch (err) {\n      console.error(\"❌ Setup error:\", err);\n      setStatus(\"error\");\n      setMessage(`Setup failed: ${err.message}`);\n    }\n  };\n  const reset = () => {\n    setStatus(\"idle\");\n    setMessage(\"\");\n    setBusinessInfo(null);\n    setNextSteps([]);\n  };\n  const forceReload = () => {\n    window.location.reload();\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      maxWidth: 720,\n      margin: \"40px auto\",\n      fontFamily: \"system-ui, sans-serif\",\n      padding: \"20px\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"WhatsApp Business \\u2014 Embedded Signup\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 7\n    }, this), appValidation && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: \"10px\",\n        marginBottom: \"20px\",\n        borderRadius: \"4px\",\n        backgroundColor: appValidation.valid ? \"#d4edda\" : \"#f8d7da\",\n        border: `1px solid ${appValidation.valid ? \"#c3e6cb\" : \"#f5c6cb\"}`,\n        color: appValidation.valid ? \"#155724\" : \"#721c24\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"App Validation:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 336,\n        columnNumber: 11\n      }, this), \" \", appValidation.valid ? \"✅ Valid\" : \"❌ Invalid\", appValidation.error && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Error: \", appValidation.error]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 35\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 9\n    }, this), sdkError && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        backgroundColor: \"#fff3cd\",\n        border: \"1px solid #ffeaa7\",\n        borderRadius: \"4px\",\n        padding: \"10px\",\n        marginBottom: \"20px\",\n        color: \"#856404\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"SDK Issue:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 11\n      }, this), \" \", sdkError, /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: \"8px\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: forceReload,\n          style: {\n            marginRight: \"8px\",\n            padding: \"4px 8px\",\n            fontSize: \"12px\"\n          },\n          children: \"Reload Page\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: testFBConnection,\n          style: {\n            padding: \"4px 8px\",\n            fontSize: \"12px\"\n          },\n          children: \"Test FB Connection\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 344,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        fontSize: \"12px\",\n        color: \"#666\",\n        marginBottom: \"20px\",\n        padding: \"10px\",\n        backgroundColor: \"#f5f5f5\",\n        borderRadius: \"4px\",\n        fontFamily: \"monospace\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Debug Info:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 388,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 389,\n        columnNumber: 9\n      }, this), \"SDK Loaded: \", isSDKLoaded ? \"✅\" : \"⏳\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 391,\n        columnNumber: 9\n      }, this), \"FB Object: \", window.FB ? \"✅\" : \"❌\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 9\n      }, this), \"App ID: \", CONFIG.APP_ID, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 395,\n        columnNumber: 9\n      }, this), \"Config ID: \", CONFIG.CONFIG_ID, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 9\n      }, this), \"API Version: \", CONFIG.API_VERSION, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 399,\n        columnNumber: 9\n      }, this), \"Redirect URI: \", CONFIG.REDIRECT_URI]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 377,\n      columnNumber: 7\n    }, this), status === \"idle\" && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: startSignup,\n        disabled: !isSDKLoaded,\n        style: {\n          padding: \"12px 20px\",\n          borderRadius: 8,\n          border: \"1px solid #25d366\",\n          backgroundColor: isSDKLoaded ? \"#25d366\" : \"#ccc\",\n          color: \"white\",\n          cursor: isSDKLoaded ? \"pointer\" : \"not-allowed\",\n          fontSize: \"16px\",\n          fontWeight: \"600\"\n        },\n        children: isSDKLoaded ? \"🚀 Connect WhatsApp Business\" : \"⏳ Loading Facebook SDK...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 405,\n        columnNumber: 11\n      }, this)\n    }, void 0, false), status === \"loading\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 16\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Setting up your account\\u2026\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 428,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 429,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 427,\n      columnNumber: 9\n    }, this), status === \"success\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 16\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\u2705 Setup Complete\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 436,\n        columnNumber: 11\n      }, this), businessInfo && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: 12,\n          padding: 16,\n          border: \"1px solid #25d366\",\n          borderRadius: 8,\n          backgroundColor: \"#f0fff4\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Business:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 448,\n            columnNumber: 17\n          }, this), \" \", businessInfo.business_name]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"WABA ID:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 451,\n            columnNumber: 17\n          }, this), \" \", businessInfo.waba_id]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Phone Numbers:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 454,\n            columnNumber: 17\n          }, this), \" \", (_businessInfo$phone_n = businessInfo.phone_numbers) === null || _businessInfo$phone_n === void 0 ? void 0 : _businessInfo$phone_n.length]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 453,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 438,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: reset,\n        style: {\n          marginTop: 16,\n          padding: \"8px 16px\"\n        },\n        children: \"\\uD83D\\uDD04 Setup Another Account\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 459,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 434,\n      columnNumber: 9\n    }, this), status === \"error\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 16\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        style: {\n          color: \"#d73502\"\n        },\n        children: \"\\u274C Setup Failed\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 470,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: \"12px\",\n          backgroundColor: \"#fff5f5\",\n          border: \"1px solid #fed7d7\",\n          borderRadius: \"6px\",\n          color: \"#c53030\",\n          whiteSpace: \"pre-line\"\n        },\n        children: message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 471,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: reset,\n        style: {\n          marginTop: 12,\n          padding: \"8px 16px\"\n        },\n        children: \"\\uD83D\\uDD04 Try Again\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 483,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 469,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 314,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"pOu0Q8JGQK0Ue26L6sC7EiDUULg=\");\n_c = App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useState","useCallback","jsxDEV","_jsxDEV","Fragment","_Fragment","CONFIG","APP_ID","API_VERSION","CONFIG_ID","BACKEND_URL","REDIRECT_URI","App","_s","_businessInfo$phone_n","isSDKLoaded","setIsSDKLoaded","sdkError","setSdkError","status","setStatus","message","setMessage","businessInfo","setBusinessInfo","nextSteps","setNextSteps","appValidation","setAppValidation","validateAppId","console","log","response","fetch","data","json","ok","id","valid","_data$error","_data$error2","error","loadFacebookSDK","window","fbAsyncInit","FB","init","appId","cookie","xfbml","version","getLoginStatus","undefined","existingScript","document","getElementById","remove","script","createElement","async","defer","crossOrigin","src","onload","onerror","head","appendChild","setTimeout","warn","messageListener","event","validOrigins","isValidOrigin","some","origin","endsWith","JSON","parse","type","_data$data","current_step","parseError","addEventListener","removeEventListener","testFBConnection","alert","startSignup","loginConfig","config_id","response_type","override_default_response_type","extras","setup","featureType","sessionInfoVersion","login","_response$authRespons","stringify","authResponse","code","length","setupBusinessAccount","authCode","requestPayload","authorization_code","redirect_uri","client_info","user_agent","navigator","userAgent","timestamp","Date","toISOString","app_validation","res","method","headers","body","result","success","business_info","next_steps","Error","err","reset","forceReload","location","reload","style","maxWidth","margin","fontFamily","padding","children","fileName","_jsxFileName","lineNumber","columnNumber","marginBottom","borderRadius","backgroundColor","border","color","marginTop","onClick","marginRight","fontSize","disabled","cursor","fontWeight","business_name","waba_id","phone_numbers","whiteSpace","_c","$RefreshReg$"],"sources":["/Users/ayoubidel/Desktop/embeddedsignup/front/src/App.js"],"sourcesContent":["import React, { useEffect, useState, useCallback } from \"react\";\n\nconst CONFIG = {\n  APP_ID: \"1187395139713463\",\n  API_VERSION: \"v23.0\",\n  CONFIG_ID: \"2282335175549472\",\n  BACKEND_URL: \"http://localhost:8081\",\n  REDIRECT_URI: \"https://c6c766eee161.ngrok-free.app\",\n};\n\nexport default function App() {\n  const [isSDKLoaded, setIsSDKLoaded] = useState(false);\n  const [sdkError, setSdkError] = useState(null);\n  const [status, setStatus] = useState(\"idle\");\n  const [message, setMessage] = useState(\"\");\n  const [businessInfo, setBusinessInfo] = useState(null);\n  const [nextSteps, setNextSteps] = useState([]);\n  const [appValidation, setAppValidation] = useState(null);\n\n  // Validate Facebook App ID\n  const validateAppId = useCallback(async () => {\n    try {\n      console.log(\"Validating Facebook App ID...\");\n      const response = await fetch(\n        `https://graph.facebook.com/v23.0/${CONFIG.APP_ID}?fields=id,name,link`,\n      );\n      const data = await response.json();\n\n      if (response.ok && data.id) {\n        console.log(\"✅ App ID is valid:\", data);\n        setAppValidation({ valid: true, data });\n      } else {\n        console.error(\"❌ App ID validation failed:\", data);\n        setAppValidation({\n          valid: false,\n          error: data.error?.message || \"App ID not found\",\n        });\n        setSdkError(\n          `Invalid App ID: ${data.error?.message || \"App not found\"}`,\n        );\n      }\n    } catch (error) {\n      console.error(\"❌ App validation network error:\", error);\n      setAppValidation({\n        valid: false,\n        error: \"Network error during validation\",\n      });\n      setSdkError(\"Network error validating App ID\");\n    }\n  }, []);\n\n  // Enhanced Facebook SDK loading\n  const loadFacebookSDK = useCallback(() => {\n    console.log(\"Starting Facebook SDK load process...\");\n    setSdkError(null);\n\n    // Validate App ID first\n    validateAppId();\n\n    // Set up fbAsyncInit BEFORE loading script\n    window.fbAsyncInit = function () {\n      console.log(\"fbAsyncInit called, initializing FB SDK...\");\n      try {\n        window.FB.init({\n          appId: CONFIG.APP_ID,\n          cookie: true,\n          xfbml: false,\n          version: CONFIG.API_VERSION,\n        });\n\n        console.log(\"FB.init completed, checking status...\");\n\n        // Test the SDK immediately\n        window.FB.getLoginStatus(function (response) {\n          console.log(\"Initial FB login status:\", response);\n          setIsSDKLoaded(true);\n          setSdkError(null);\n          console.log(\"✅ Facebook SDK fully initialized and tested\");\n        });\n      } catch (error) {\n        console.error(\"❌ FB.init failed:\", error);\n        setSdkError(`SDK initialization failed: ${error.message}`);\n      }\n    };\n\n    // Check if FB SDK already exists\n    if (window.FB && window.FB.init) {\n      console.log(\"Facebook SDK already loaded, testing...\");\n      try {\n        window.FB.getLoginStatus(function (response) {\n          console.log(\"Existing FB SDK status:\", response);\n          setIsSDKLoaded(true);\n          setSdkError(null);\n        });\n        return;\n      } catch (error) {\n        console.log(\"Existing FB SDK has issues, reloading...\");\n        window.FB = undefined;\n      }\n    }\n\n    // Remove any existing script\n    const existingScript = document.getElementById(\"facebook-jssdk\");\n    if (existingScript) {\n      console.log(\"Removing existing FB SDK script...\");\n      existingScript.remove();\n    }\n\n    // Create and load new script\n    console.log(\"Loading Facebook SDK script...\");\n    const script = document.createElement(\"script\");\n    script.id = \"facebook-jssdk\";\n    script.async = true;\n    script.defer = true;\n    script.crossOrigin = \"anonymous\";\n    script.src = \"https://connect.facebook.net/en_US/sdk.js\";\n\n    script.onload = () => {\n      console.log(\"✅ Facebook SDK script loaded successfully\");\n    };\n\n    script.onerror = (error) => {\n      console.error(\"❌ Failed to load Facebook SDK script:\", error);\n      setSdkError(\n        \"Failed to load Facebook SDK script. Check your internet connection or if Facebook is blocked.\",\n      );\n    };\n\n    document.head.appendChild(script);\n\n    // Timeout fallback\n    setTimeout(() => {\n      if (!isSDKLoaded) {\n        console.warn(\"⚠️ Facebook SDK initialization timeout\");\n        setSdkError(\n          \"Facebook SDK took too long to initialize. This might indicate:\",\n        );\n        setMessage(\n          \"• Your app is in Development mode\\n• Invalid App ID\\n• Network/firewall issues\\n• Facebook domains blocked\",\n        );\n      }\n    }, 15000);\n  }, [validateAppId, isSDKLoaded]);\n\n  useEffect(() => {\n    loadFacebookSDK();\n  }, [loadFacebookSDK]);\n\n  // Enhanced message listener\n  useEffect(() => {\n    const messageListener = (event) => {\n      console.log(\"Received message event:\", event);\n\n      const validOrigins = [\n        \"https://www.facebook.com\",\n        \"https://business.facebook.com\",\n      ];\n\n      const isValidOrigin = validOrigins.some(\n        (origin) =>\n          event.origin === origin || event.origin.endsWith(\".facebook.com\"),\n      );\n\n      if (!isValidOrigin) {\n        console.log(\"Ignoring message from invalid origin:\", event.origin);\n        return;\n      }\n\n      try {\n        const data =\n          typeof event.data === \"string\" ? JSON.parse(event.data) : event.data;\n        console.log(\"Parsed message data:\", data);\n\n        if (data?.type === \"WA_EMBEDDED_SIGNUP\") {\n          console.log(\"🟢 WA Embedded Signup event:\", data);\n\n          if (data.event === \"FINISH\") {\n            console.log(\"✅ Signup completed successfully:\", data.data);\n          } else if (data.event === \"CANCEL\") {\n            console.log(\"❌ Signup cancelled:\", data.data);\n            setStatus(\"error\");\n            setMessage(\n              `Signup cancelled at: ${data.data?.current_step || \"unknown step\"}`,\n            );\n          } else {\n            console.log(\"ℹ️ Other signup event:\", data.event);\n          }\n        }\n      } catch (parseError) {\n        console.log(\"Non-JSON message received:\", event.data);\n      }\n    };\n\n    window.addEventListener(\"message\", messageListener);\n    return () => window.removeEventListener(\"message\", messageListener);\n  }, []);\n\n  const testFBConnection = () => {\n    if (!window.FB) {\n      alert(\"Facebook SDK not loaded\");\n      return;\n    }\n\n    console.log(\"Testing Facebook connection...\");\n    window.FB.getLoginStatus(function (response) {\n      console.log(\"FB Connection Test Result:\", response);\n      alert(`FB Status: ${response.status}`);\n    });\n  };\n\n  const startSignup = () => {\n    if (!isSDKLoaded || !window.FB) {\n      setMessage(\"Facebook SDK not ready. Please wait or refresh the page.\");\n      return;\n    }\n\n    console.log(\"🚀 Starting WhatsApp Business signup...\");\n    setStatus(\"loading\");\n    setMessage(\"Opening WhatsApp Business signup...\");\n\n    const loginConfig = {\n      config_id: CONFIG.CONFIG_ID,\n      response_type: \"code\",\n      override_default_response_type: true,\n      extras: {\n        setup: {},\n        featureType: \"\",\n        sessionInfoVersion: \"3\",\n      },\n    };\n\n    console.log(\"FB.login config:\", loginConfig);\n\n    window.FB.login((response) => {\n      console.log(\"📥 FB.login response received:\", response);\n\n      if (response.error) {\n        console.error(\"❌ FB.login error:\", response.error);\n        setStatus(\"error\");\n        setMessage(\n          `Facebook login error: ${response.error.message || JSON.stringify(response.error)}`,\n        );\n        return;\n      }\n\n      if (response.status === \"connected\" && response.authResponse?.code) {\n        const code = response.authResponse.code;\n        console.log(\"✅ Authorization code received, length:\", code.length);\n        setupBusinessAccount(code);\n      } else {\n        console.log(\n          \"❌ No authorization code received. Full response:\",\n          response,\n        );\n        setStatus(\"error\");\n        setMessage(\n          `No authorization code received. Status: ${response.status}. This may indicate the signup was cancelled or the app configuration is incorrect.`,\n        );\n      }\n    }, loginConfig);\n  };\n\n  const setupBusinessAccount = async (authCode) => {\n    try {\n      setMessage(\"Server is processing your WhatsApp Business setup...\");\n      console.log(\"📤 Sending to backend with code length:\", authCode.length);\n\n      const requestPayload = {\n        authorization_code: authCode,\n        redirect_uri: CONFIG.REDIRECT_URI,\n        client_info: {\n          user_agent: navigator.userAgent,\n          timestamp: new Date().toISOString(),\n          app_validation: appValidation,\n        },\n      };\n\n      const res = await fetch(`${CONFIG.BACKEND_URL}/api/whatsapp/setup`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(requestPayload),\n      });\n\n      const result = await res.json();\n      console.log(\"📥 Backend response:\", result);\n\n      if (result.success) {\n        setStatus(\"success\");\n        setMessage(result.message || \"WhatsApp Business setup completed.\");\n        setBusinessInfo(result.business_info || null);\n        setNextSteps(result.next_steps || []);\n      } else {\n        throw new Error(result.error || `Server error: ${res.status}`);\n      }\n    } catch (err) {\n      console.error(\"❌ Setup error:\", err);\n      setStatus(\"error\");\n      setMessage(`Setup failed: ${err.message}`);\n    }\n  };\n\n  const reset = () => {\n    setStatus(\"idle\");\n    setMessage(\"\");\n    setBusinessInfo(null);\n    setNextSteps([]);\n  };\n\n  const forceReload = () => {\n    window.location.reload();\n  };\n\n  return (\n    <div\n      style={{\n        maxWidth: 720,\n        margin: \"40px auto\",\n        fontFamily: \"system-ui, sans-serif\",\n        padding: \"20px\",\n      }}\n    >\n      <h1>WhatsApp Business — Embedded Signup</h1>\n\n      {/* App Validation Status */}\n      {appValidation && (\n        <div\n          style={{\n            padding: \"10px\",\n            marginBottom: \"20px\",\n            borderRadius: \"4px\",\n            backgroundColor: appValidation.valid ? \"#d4edda\" : \"#f8d7da\",\n            border: `1px solid ${appValidation.valid ? \"#c3e6cb\" : \"#f5c6cb\"}`,\n            color: appValidation.valid ? \"#155724\" : \"#721c24\",\n          }}\n        >\n          <strong>App Validation:</strong>{\" \"}\n          {appValidation.valid ? \"✅ Valid\" : \"❌ Invalid\"}\n          {appValidation.error && <div>Error: {appValidation.error}</div>}\n        </div>\n      )}\n\n      {/* SDK Error Display */}\n      {sdkError && (\n        <div\n          style={{\n            backgroundColor: \"#fff3cd\",\n            border: \"1px solid #ffeaa7\",\n            borderRadius: \"4px\",\n            padding: \"10px\",\n            marginBottom: \"20px\",\n            color: \"#856404\",\n          }}\n        >\n          <strong>SDK Issue:</strong> {sdkError}\n          <div style={{ marginTop: \"8px\" }}>\n            <button\n              onClick={forceReload}\n              style={{\n                marginRight: \"8px\",\n                padding: \"4px 8px\",\n                fontSize: \"12px\",\n              }}\n            >\n              Reload Page\n            </button>\n            <button\n              onClick={testFBConnection}\n              style={{ padding: \"4px 8px\", fontSize: \"12px\" }}\n            >\n              Test FB Connection\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Debug Info */}\n      <div\n        style={{\n          fontSize: \"12px\",\n          color: \"#666\",\n          marginBottom: \"20px\",\n          padding: \"10px\",\n          backgroundColor: \"#f5f5f5\",\n          borderRadius: \"4px\",\n          fontFamily: \"monospace\",\n        }}\n      >\n        <strong>Debug Info:</strong>\n        <br />\n        SDK Loaded: {isSDKLoaded ? \"✅\" : \"⏳\"}\n        <br />\n        FB Object: {window.FB ? \"✅\" : \"❌\"}\n        <br />\n        App ID: {CONFIG.APP_ID}\n        <br />\n        Config ID: {CONFIG.CONFIG_ID}\n        <br />\n        API Version: {CONFIG.API_VERSION}\n        <br />\n        Redirect URI: {CONFIG.REDIRECT_URI}\n      </div>\n\n      {status === \"idle\" && (\n        <>\n          <button\n            onClick={startSignup}\n            disabled={!isSDKLoaded}\n            style={{\n              padding: \"12px 20px\",\n              borderRadius: 8,\n              border: \"1px solid #25d366\",\n              backgroundColor: isSDKLoaded ? \"#25d366\" : \"#ccc\",\n              color: \"white\",\n              cursor: isSDKLoaded ? \"pointer\" : \"not-allowed\",\n              fontSize: \"16px\",\n              fontWeight: \"600\",\n            }}\n          >\n            {isSDKLoaded\n              ? \"🚀 Connect WhatsApp Business\"\n              : \"⏳ Loading Facebook SDK...\"}\n          </button>\n        </>\n      )}\n\n      {status === \"loading\" && (\n        <div style={{ marginTop: 16 }}>\n          <strong>Setting up your account…</strong>\n          <p>{message}</p>\n        </div>\n      )}\n\n      {status === \"success\" && (\n        <div style={{ marginTop: 16 }}>\n          <h3>✅ Setup Complete</h3>\n          <p>{message}</p>\n          {businessInfo && (\n            <div\n              style={{\n                marginTop: 12,\n                padding: 16,\n                border: \"1px solid #25d366\",\n                borderRadius: 8,\n                backgroundColor: \"#f0fff4\",\n              }}\n            >\n              <div>\n                <strong>Business:</strong> {businessInfo.business_name}\n              </div>\n              <div>\n                <strong>WABA ID:</strong> {businessInfo.waba_id}\n              </div>\n              <div>\n                <strong>Phone Numbers:</strong>{\" \"}\n                {businessInfo.phone_numbers?.length}\n              </div>\n            </div>\n          )}\n          <button\n            onClick={reset}\n            style={{ marginTop: 16, padding: \"8px 16px\" }}\n          >\n            🔄 Setup Another Account\n          </button>\n        </div>\n      )}\n\n      {status === \"error\" && (\n        <div style={{ marginTop: 16 }}>\n          <h3 style={{ color: \"#d73502\" }}>❌ Setup Failed</h3>\n          <div\n            style={{\n              padding: \"12px\",\n              backgroundColor: \"#fff5f5\",\n              border: \"1px solid #fed7d7\",\n              borderRadius: \"6px\",\n              color: \"#c53030\",\n              whiteSpace: \"pre-line\",\n            }}\n          >\n            {message}\n          </div>\n          <button\n            onClick={reset}\n            style={{ marginTop: 12, padding: \"8px 16px\" }}\n          >\n            🔄 Try Again\n          </button>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}